<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="assets/images/logo.jpg">
    <link rel="stylesheet" href="assets/style.css">
</head>

<body>

<!-- Navbar -->
<section class="header_menu" id="header_menu">
    <div class="container-fluid px-0 shadow">
        <nav class="navbar navbar-expand-lg navbar-light bg-light py-3">
            <a class="navbar-brand pl-5 pl-small-0" href="index.html">
                <img src="assets/images/logo.jpg" class="img img-fluid" width="120px" alt="logo">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="product.html">Product</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Category.html">Category</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contact.html">Contact Us</a>
                    </li>
                </ul>
                <div class="search mr-3">
                    <a href="search.html" class="btn btn-sm btn-outline-primary">Search</a>
                </div>
                <div class="cart">
                    <a href="cart.html">
                        <i class="fas fa-shopping-cart fa-2x"></i>
                        <span class="badge badge-pill badge-primary" id="cart-count">0</span>
                    </a>
                </div>
            </div>
        </nav>
    </div>
</section>
<!-- Order Page -->
<section class="order-section details-conatiner" id="order">
    <div class="container">
        <div class="row">
            <!-- Billing Details Column -->
            <div class="col-md-8 form-container ">
                <h1>Checkout</h1>
                <form id="user-details-form">
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="first-name">First name</label>
                            <input type="text" class="form-control" id="first-name" required>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="last-name">Last name</label>
                            <input type="text" class="form-control" id="last-name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="text" class="form-control" id="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email address</label>
                        <input type="email" class="form-control" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="country">Country</label>
                        <select class="form-control" id="country" required>
                            <option value="">Choose your option</option>
                            <option value="india">India</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="address-line-1">Address Line 1</label>
                        <input type="text" class="form-control" id="address-line-1" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="postcode">Postcode / ZIP</label>
                            <input type="text" class="form-control" id="postcode" required>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="town-city">Town / City</label>
                            <input type="text" class="form-control" id="town-city" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="additional-info">Additional information</label>
                        <textarea class="form-control" id="additional-info" rows="3"></textarea>
                    </div>
                    <button class="btn btn-primary mx-auto" type="submit">Purchase</button>
                </form>
            </div>
            <!-- Order Summary Column -->
            <div class="col-md-4">
                <div class="order-summary">
                    <h4>Order summary</h4>
                    <div id="order-items"></div>
                    <hr>
                    <div id="order-total">
                        <h4>Total: ₹0</h4>
                    </div>
                    <div id="shipment-charges">Shipment Charges: ₹0</div>
                    <div id="discount">Discount: 0%</div>
                    <div id="saved-money">You Saved: ₹0</div>
                    <div id="final-total">Final Total: ₹0</div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Footer -->
<footer class="footer mt-5 py-4 bg-light">
    <div class="container">
        <div class="row">
            <!-- Company Info -->
            <div class="col-md-4">
                <div class="footer-logo">
                    <img src="assets/images/logo.png" alt="Company Logo" class="img-fluid mb-3" width="150">
                </div>
                <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Impedit, totam est illum ipsum quas ad
                    dignissimos magni veritatis natus voluptatem.</p>
            </div>
            <!-- Quick Links -->
            <div class="col-md-2">
                <h5>Quick Links</h5>
                <ul class="list-unstyled">
                    <li><a href="about.html">About</a></li>
                    <li><a href="offers.html">Offers & Discounts</a></li>
                    <li><a href="coupon.html">Get Coupon</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
            </div>
            <!-- New Products -->
            <div class="col-md-3">
                <h5>New Products</h5>
                <ul class="list-unstyled">
                    <li><a href="#">Woman Cloth</a></li>
                    <li><a href="#">Fashion Accessories</a></li>
                    <li><a href="#">Man Accessories</a></li>
                    <li><a href="#">Rubber made Toys</a></li>
                </ul>
            </div>
            <!-- Support -->
            <div class="col-md-3">
                <h5>Support</h5>
                <ul class="list-unstyled">
                    <li><a href="faq.html">Frequently Asked Questions</a></li>
                    <li><a href="terms.html">Terms & Conditions</a></li>
                    <li><a href="privacy.html">Privacy Policy</a></li>
                    <li><a href="report.html">Report a Payment Issue</a></li>
                </ul>
            </div>
        </div>
        <!-- Social Media -->
        <div class="row mt-3">
            <div class="col text-center">
                <a href="#" class="text-dark mx-2"><i class="fab fa-facebook fa-2x"></i></a>
                <a href="#" class="text-dark mx-2"><i class="fab fa-twitter fa-2x"></i></a>
                <a href="#" class="text-dark mx-2"><i class="fab fa-instagram fa-2x"></i></a>
                <a href="#" class="text-dark mx-2"><i class="fab fa-linkedin fa-2x"></i></a>
            </div>
        </div>
    </div>
</footer>
<button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fa-solid fa-arrow-up"></i></button>
<script src="assets/main.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    function updateOrder() {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let orderHtml = '';
        let total = 0;
        let shipmentCharges = 50; // Example fixed shipment charges
        let discountPercentage = 10; // 10% discount on every product
        let discount = 0; // Initialize total discount amount
        let savedMoney = 0; // Initialize total saved money

        if (cart.length === 0) {
            // Cart is empty
            $('#order-items').html('<p>Your cart is empty.</p>');
            $('#order-total').find('h4').text('Total: ₹0');
            $('#shipment-charges').text('Shipment Charges: ₹0');
            $('#discount').text(`Discount: ${discountPercentage}%`);
            $('#saved-money').text('You Saved: ₹0');
            $('#final-total').text('Final Total: ₹0');
            return; // Exit the function
        }

        cart.forEach(item => {
            let itemTotalPrice = item.price * item.quantity;
            let itemDiscount = itemTotalPrice * (discountPercentage / 100); // 10% discount on the total price of the item
            let itemSavedMoney = itemDiscount; // Money saved due to discount

            total += itemTotalPrice;
            discount += itemDiscount;
            savedMoney += itemSavedMoney;

            orderHtml += `
                <div class="order-item mb-3">
                    <div class="row">
                        <div class="col-md-4">
                            <img src="${item.image}" class="img-fluid" alt="${item.name}">
                        </div>
                        <div class="col-md-8">
                            <h5>${item.name}</h5>
                            <p>Price: ₹${item.price}</p>
                            <p>Discount: -₹${itemDiscount.toFixed(2)} (${discountPercentage}%)</p>
                            <p>Quantity: ${item.quantity}</p>
                            <p>Total: ₹${itemTotalPrice.toFixed(2)}</p>
                        </div>
                    </div>
                </div>
                <hr>
            `;
        });

        $('#order-items').html(orderHtml);
        $('#order-total').find('h4').text(`Total: ₹${total.toFixed(2)}`);
        $('#shipment-charges').text(`Shipment Charges: ₹${shipmentCharges.toFixed(2)}`);
        $('#discount').text(`Discount: ₹${discount.toFixed(2)} (${discountPercentage}%)`);
        $('#saved-money').text(`You Saved: ₹${savedMoney.toFixed(2)}`);
        $('#final-total').text(`Final Total: ₹${(total + shipmentCharges - discount).toFixed(2)}`);
    }

    $('#user-details-form').on('submit', function (e) {
        e.preventDefault();
        let firstName = $('#first-name').val();
        let lastName = $('#last-name').val();
        let phone = $('#phone').val();
        let email = $('#email').val();
        let country = $('#country').val();
        let addressLine1 = $('#address-line-1').val();
        let addressLine2 = $('#address-line-2').val();
        let postcode = $('#postcode').val();
        let townCity = $('#town-city').val();
        let additionalInfo = $('#additional-info').val();

        let order = {
            cart: JSON.parse(localStorage.getItem('cart')) || [],
            user: {
                firstName,
                lastName,
                phone,
                email,
                country,
                addressLine1,
                addressLine2,
                postcode,
                townCity,
                additionalInfo
            }
        };

        localStorage.setItem('order', JSON.stringify(order));
        let orderId = Date.now(); // Generate a simple order ID
        window.location.href = `order_confirmation.html?orderId=${orderId}&email=${email}&status=Processing`;
    });

    $(document).ready(function () {
        updateOrder();
    });
</script>
</body>
</html>
